<head>
  <link href="https://fonts.googleapis.com/css?family=VT323" rel="stylesheet">
  <style>
    #game {
      font-family: 'VT323', monospace;
      font-size: 20px;
    }
    .value1 {
      color: green;
    }
    .value0 {
      color: red;
    }
  </style>
</head>

<html>
  <div id="game">
    <div id="gameField"></div>
  </div>
</html>
<script>
  var width = 10;
  var height = 10;

  var livingConditions = [2,3];
  var bornConditions = [3];
  function setupRandom()
  {
    field = new Object();
    for(var h = 0; h < height; h++)
    {

      field[h] = (field[h] == undefined) ? new Object() : field[h];
      for(var w = 0; w < width; w++)
      {
        field[h][w] = Math.round(Math.random());
      }
    }
  }

  function updateField()
  {
    //First empty the field
    var gameField = document.getElementById('gameField');
    console.log(gameField);
    while(gameField.hasChildNodes())
    {
      gameField.removeChild(gameField.lastChild);
    }
    //Set new Lines
    for(var h in field)
    {
      var line = document.createElement("div");
      line.setAttribute("id", "line"+h);
      for(var w in field[h])
      {
        var number = document.createElement("span");
        number.textContent = field[h][w];
        number.setAttribute("class", "value" + field[h][w]);
        number.setAttribute("id", "pos" + h + "x" + w);
        line.appendChild(number);
      }
      gameField.appendChild(line);
    }
  }

  function nextStep()
  {
    var nextField = new Object();

    //Sequential iteration because of Problems with calculateLiveNeighbors
    for(var h = 0; h < height; h++)
    {
      nextField[h] = new Object();
      for(var w = 0; w < width; w++)
      {
        var LiveNeighbors = calculateLiveNeighbors(h,w);

        //Check if current cell is alive
        if(field[h][w])
        {
          nextField[h][w] = (livingConditions.indexOf(LiveNeighbors) > -1) ?
                            1 : 0;
        }
        else {
          nextField[h][w] = (bornConditions.indexOf(LiveNeighbors) > -1) ?
                            1 : 0;
        }
      }
    }
    field=nextField;
    updateField();
  }

  function calculateLiveNeighbors(h,w)
  {
    var sumOfLiveNeighbors = 0;
    for(var currentH = h-1; currentH<=h+1; currentH++)
    {
      if(currentH > -1 && currentH < height)
        for(var currentW = w-1; currentW<=w+1; currentW++)
        {
          sumOfLiveNeighbors += (currentW > -1 && currentW < width) ? field[currentH][currentW] : 0;
        }
    }
    return sumOfLiveNeighbors-field[h][w];
  }

  setupRandom();
  updateField();
</script>
